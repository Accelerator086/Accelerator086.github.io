<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Financial Derivatives Chapter 3：Non-arbitrary Pricing Theory &amp; Binomial Trees | Accelerator086</title><meta name="keywords" content="Financial Mathematics,Undergraduate,Financial Derivatives"><meta name="author" content="Accelerator086"><meta name="copyright" content="Accelerator086"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="金融衍生工具 &amp; 金融定价分析 Chapter 3">
<meta property="og:type" content="article">
<meta property="og:title" content="Financial Derivatives Chapter 3：Non-arbitrary Pricing Theory &amp; Binomial Trees">
<meta property="og:url" content="http://accelerator086.github.io/2019/01/17/Notes-for-Financial-Derivatives-3/index.html">
<meta property="og:site_name" content="Accelerator086">
<meta property="og:description" content="金融衍生工具 &amp; 金融定价分析 Chapter 3">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://accelerator086.github.io/pic/15888928.jpg">
<meta property="article:published_time" content="2019-01-16T16:00:00.000Z">
<meta property="article:modified_time" content="2021-11-13T09:33:27.580Z">
<meta property="article:author" content="Accelerator086">
<meta property="article:tag" content="Financial Mathematics">
<meta property="article:tag" content="Undergraduate">
<meta property="article:tag" content="Financial Derivatives">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://accelerator086.github.io/pic/15888928.jpg"><link rel="shortcut icon" href="/pic/favicon.ico"><link rel="canonical" href="http://accelerator086.github.io/2019/01/17/Notes-for-Financial-Derivatives-3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":800,"languages":{"author":"作者: Accelerator086","link":"链接: ","source":"来源: Accelerator086","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Financial Derivatives Chapter 3：Non-arbitrary Pricing Theory & Binomial Trees',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2021-11-13 17:33:27'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    document.addEventListener('pjax:complete', detectApple)})(window)</script><style type="text/css">#toggle-sidebar {left:100px}</style><meta name="generator" content="Hexo 5.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/pic/15888928.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/selftalk/"><i class="fa-fw fas fa-heart"></i><span> Selftalk</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://blogwaline-alpha.vercel.app/ui"><i class="fa-fw fas fa-suitcase"></i><span> Backstage</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Accelerator086</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/selftalk/"><i class="fa-fw fas fa-heart"></i><span> Selftalk</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://blogwaline-alpha.vercel.app/ui"><i class="fa-fw fas fa-suitcase"></i><span> Backstage</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Financial Derivatives Chapter 3：Non-arbitrary Pricing Theory &amp; Binomial Trees</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2019-01-16T16:00:00.000Z" title="发表于 2019-01-17 00:00:00">2019-01-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-11-13T09:33:27.580Z" title="更新于 2021-11-13 17:33:27">2021-11-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Financial-Derivatives/">Financial Derivatives</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>8分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Financial Derivatives Chapter 3：Non-arbitrary Pricing Theory &amp; Binomial Trees"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div><article class="post-content" id="article-container"><h2 id="套利-arbitrage">套利 Arbitrage</h2>
<p>在某项资产的交易过程中，交易者可以在不需要期初投资支出的条件下，获得无风险利润。其中：</p>
<ul>
<li>商品市场：同一资产在两个不同的市场上进行交易，但各个市场上的交易价格不同，如果没有其他约束，就存在套利机会。
<ul>
<li>商品市场套利策略：低买高卖</li>
</ul></li>
<li>金融市场：两项金融产品A，B，在期末有相同的现金流（称为互相复制），如果在期初的价格不同，就有套利机会。
<ul>
<li>金融市场套利策略：高卖低买</li>
</ul></li>
</ul>
<h3 id="无套利定价原则">无套利定价原则</h3>
<p>在无套利市场中，如果两项金融产品在到期日的价值完全相同，则它们在到期日之前任意时刻的价值也必然相同。其中：</p>
<ul>
<li>复制：如果产品A和产品B未来的现金流状态完全相同，称A和B互相复制。</li>
</ul>
<p>无套利定价的关键技术是所谓“复制”技术，即用一组已知价格的证券来复制待定价格的金融产品。</p>
<blockquote>
<p>上述内容参考书籍：</p>
<p>《An Elementary Introduction to Mathematical Finance》</p>
<ul>
<li>Chapter 5 Pricing Contracts via Arbitrage</li>
<li>Chapter 6 The Arbitrage Theorem</li>
</ul>
<p>《The Mathematics for Finance: Modeling and Hedging》</p>
<ul>
<li>Chapter 2 Binomial Trees, Replicating Portfolios, and Arbitrage</li>
</ul>
</blockquote>
<h2 id="期权定价的二叉树模型-binomial-tree">期权定价的二叉树模型 Binomial Tree</h2>
<blockquote>
<p>Example：</p>
<p>假设一种不支付红利的股票当前市价100元，我们得知1年后，该股票的价格可以是110元、90元，而概率未给定。即期利率为5%，问：1年后到期执行价格为100元的该股票的欧式看涨期权的公平价格是多少？<span class="math inline">\(\frac{50}{7}\)</span></p>
<p>欧式看跌期权呢？</p>
</blockquote>
<h3 id="一般二叉树模型">一般二叉树模型</h3>
<p>假设一个无红利支付的股票，当前时刻 t 的价值是 <span class="math inline">\(S_t\)</span> ，期末时刻 T 的价值是 <span class="math inline">\(S_T\)</span> 。有两种市场状态，即 <span class="math inline">\(S_T\)</span> 只可能取到两个值： <span class="math inline">\(S_T=uS_0,u&gt;1\)</span> 或者 <span class="math inline">\(S_T=dS_0,d&lt;1\)</span> 。设无风险连续年利率利率为 <span class="math inline">\(r\)</span> 。</p>
<p>则容易得到 <span class="math display">\[
d&lt;e^{r(T-t)}&lt;u
\]</span></p>
<blockquote>
<p>证明：不等式均乘以 <span class="math inline">\(S_t\)</span> ，看作债券并获取套利。</p>
</blockquote>
<h3 id="单期二叉树模型">单期二叉树模型</h3>
<h4 id="无套利定价法下欧式期权定价公式">无套利定价法下欧式期权定价公式</h4>
<p><span class="math display">\[
\displaylines{f=e^{-r(T-t)}[pf_u+(1-p)f_d] \\ p=\frac{e^{r(T-t)}-d}{u-d}}
\]</span></p>
<blockquote>
<p>证明：</p>
<p>构造一个由 <span class="math inline">\(\Delta\)</span> 股股票多头和一个期权空头组成的资产组合，并计算出该组合为无风险资产组合时的Δ值 <span class="math display">\[
\Delta=\frac{f_u-f_d}{u*S_t-d*S_t}
\]</span></p>
<p>其中 <span class="math inline">\(f_{u},f_{d}\)</span> 分别为期权在股票上涨和下跌时的价值。上式的 <span class="math inline">\(\Delta\)</span> 通常称为套期保值比例。</p>
<p>该无风险组合现值为 <span class="math inline">\((u*S_t*\Delta-f_u)e^{r(T-t)}\)</span> ，与构造该组合的成本 <span class="math inline">\(S_t*\Delta-f\)</span> 相等。</p>
</blockquote>
<h4 id="delta对冲技术">Delta对冲技术</h4>
<p>建立一个包含衍生品头寸和基础资产头寸的无风险的资产组合。若数量适当，基础资产多头的赢利就会与衍生品的空头亏损相抵，实现瞬间无风险。</p>
<p>无风险组合的收益率必须等于无风险利率。</p>
<h4 id="风险中性定价方法risk-neutral-valuation">风险中性定价方法：Risk Neutral Valuation</h4>
<p><img src="https://raw.githubusercontent.com/Accelerator086/accelerator086-image-upload/master/20211113000730.png" /></p>
<p><img src="https://raw.githubusercontent.com/Accelerator086/accelerator086-image-upload/master/20211113000751.png" /></p>
<h3 id="两期二叉树模型-多期二叉树模型">两期二叉树模型 / 多期二叉树模型</h3>
<h4 id="期权定价方法倒退定价法风险中性定价法">期权定价方法：倒退定价法、风险中性定价法</h4>
<p>应用领域：欧式期权、美式期权（注意倒退定价法的价格比较）、敲出期权（注意敲出价格）</p>
<h4 id="多期二叉树中的参数">多期二叉树中的参数</h4>
<p>股票的波动率为<span class="math inline">\(\sigma\)</span>，由此可以设，当<span class="math inline">\(\text{Δt}\)</span>很小时： <span class="math display">\[
u = e^{\sigma\sqrt{T/N}},d = 1/u = e^{- \sigma\sqrt{\text{Δt}}},\Delta t = T/N
\]</span></p>
<p>此为波动率假设。</p>
<h3 id="期权二叉树定价-using-python">期权二叉树定价 Using Python</h3>
<blockquote>
<p>Source：《Python for Finance》1st Edition</p>
<ul>
<li>Chapter 8 5.2 Binomial Option Pricing</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># model &amp; option Parameters 参数化</span></span><br><span class="line">S0 = <span class="number">100.</span>  <span class="comment"># initial index level</span></span><br><span class="line">T = <span class="number">1.</span>  <span class="comment"># call option maturity</span></span><br><span class="line">r = <span class="number">0.05</span>  <span class="comment"># constant short rate</span></span><br><span class="line">vola = <span class="number">0.20</span>  <span class="comment"># constant volatility factor of diffusion</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># time parameters</span></span><br><span class="line">M = <span class="number">1000</span>  <span class="comment"># time steps</span></span><br><span class="line">dt = T / M  <span class="comment"># length of time interval</span></span><br><span class="line">df = exp(-r * dt)  <span class="comment"># discount factor per time interval</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># binomial parameters</span></span><br><span class="line">u = exp(vola * sqrt(dt))  <span class="comment"># up-movement</span></span><br><span class="line">d = <span class="number">1</span> / u  <span class="comment"># down-movement</span></span><br><span class="line">q = (exp(r * dt) - d) / (u - d)  <span class="comment"># martingale probability</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">binomial_py</span>(<span class="params">strike</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; Binomial option pricing via looping.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Parameters</span></span><br><span class="line"><span class="string">    ==========</span></span><br><span class="line"><span class="string">    strike : float</span></span><br><span class="line"><span class="string">        strike price of the European call option</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># LOOP 1 - Index Levels</span></span><br><span class="line">    S = np.zeros((M + <span class="number">1</span>, M + <span class="number">1</span>), dtype=np.float64)</span><br><span class="line">      <span class="comment"># index level array</span></span><br><span class="line">    S[<span class="number">0</span>, <span class="number">0</span>] = S0</span><br><span class="line">    z1 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, M + <span class="number">1</span>, <span class="number">1</span>):</span><br><span class="line">        z1 = z1 + <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(z1 + <span class="number">1</span>):</span><br><span class="line">            S[i, j] = S[<span class="number">0</span>, <span class="number">0</span>] * (u ** j) * (d ** (i * <span class="number">2</span>))</span><br><span class="line">            </span><br><span class="line">    <span class="comment"># LOOP 2 - Inner Values</span></span><br><span class="line">    iv = np.zeros((M + <span class="number">1</span>, M + <span class="number">1</span>), dtype=np.float64)</span><br><span class="line">      <span class="comment"># inner value array</span></span><br><span class="line">    z2 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, M + <span class="number">1</span>, <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(z2 + <span class="number">1</span>):</span><br><span class="line">            iv[i, j] = <span class="built_in">max</span>(S[i, j] - strike, <span class="number">0</span>)</span><br><span class="line">        z2 = z2 + <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment"># LOOP 3 - Valuation</span></span><br><span class="line">    pv = np.zeros((M + <span class="number">1</span>, M + <span class="number">1</span>), dtype=np.float64)</span><br><span class="line">      <span class="comment"># present value array</span></span><br><span class="line">    pv[:, M] = iv[:, M]  <span class="comment"># initialize last time point</span></span><br><span class="line">    z3 = M + <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(M - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        z3 = z3 - <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(z3):</span><br><span class="line">            pv[i, j] = (q * pv[i, j + <span class="number">1</span>] +</span><br><span class="line">                        (<span class="number">1</span> - q) * pv[i + <span class="number">1</span>, j + <span class="number">1</span>]) * df</span><br><span class="line">    <span class="keyword">return</span> pv[<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">%time <span class="built_in">round</span>(binomial_py(<span class="number">100</span>), <span class="number">3</span>) <span class="comment">#计算European Call Option现值，保留三位小数，并给出时间</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">CPU times: user 1.58 s, sys: 30 ms, total: 1.61 s</span></span><br><span class="line"><span class="string">Wall time: 1.64 s</span></span><br><span class="line"><span class="string">10.449</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">binomial_np</span>(<span class="params">strike</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; Binomial option pricing with NumPy.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Parameters</span></span><br><span class="line"><span class="string">    ==========</span></span><br><span class="line"><span class="string">    strike : float</span></span><br><span class="line"><span class="string">        strike price of the European call option</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># Index Levels with NumPy</span></span><br><span class="line">    mu = np.arange(M + <span class="number">1</span>)</span><br><span class="line">    mu = np.resize(mu, (M + <span class="number">1</span>, M + <span class="number">1</span>))</span><br><span class="line">    md = np.transpose(mu)</span><br><span class="line">    mu = u ** (mu - md)</span><br><span class="line">    md = d ** md</span><br><span class="line">    S = S0 * mu * md</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Valuation Loop</span></span><br><span class="line">    pv = np.maximum(S - strike, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    z = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(M - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):  <span class="comment"># backwards iteration</span></span><br><span class="line">        pv[<span class="number">0</span>:M - z, t] = (q * pv[<span class="number">0</span>:M - z, t + <span class="number">1</span>]</span><br><span class="line">                        + (<span class="number">1</span> - q) * pv[<span class="number">1</span>:M - z + <span class="number">1</span>, t + <span class="number">1</span>]) * df</span><br><span class="line">        z += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> pv[<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">M = <span class="number">4</span>  <span class="comment"># four time steps only</span></span><br><span class="line">mu = np.arange(M + <span class="number">1</span>)</span><br><span class="line">mu </span><br><span class="line"></span><br><span class="line">mu = np.resize(mu, (M + <span class="number">1</span>, M + <span class="number">1</span>))</span><br><span class="line">mu </span><br><span class="line"></span><br><span class="line">md = np.transpose(mu)</span><br><span class="line">md</span><br><span class="line"></span><br><span class="line">mu = u ** (mu - md)</span><br><span class="line">mu.<span class="built_in">round</span>(<span class="number">3</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([[ 1.   ,  1.006,  1.013,  1.019,  1.026],</span></span><br><span class="line"><span class="string">       [ 0.994,  1.   ,  1.006,  1.013,  1.019],</span></span><br><span class="line"><span class="string">       [ 0.987,  0.994,  1.   ,  1.006,  1.013],</span></span><br><span class="line"><span class="string">       [ 0.981,  0.987,  0.994,  1.   ,  1.006],</span></span><br><span class="line"><span class="string">       [ 0.975,  0.981,  0.987,  0.994,  1.   ]])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">md = d ** md</span><br><span class="line">md.<span class="built_in">round</span>(<span class="number">3</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([[ 1.   ,  1.   ,  1.   ,  1.   ,  1.   ],</span></span><br><span class="line"><span class="string">       [ 0.994,  0.994,  0.994,  0.994,  0.994],</span></span><br><span class="line"><span class="string">       [ 0.987,  0.987,  0.987,  0.987,  0.987],</span></span><br><span class="line"><span class="string">       [ 0.981,  0.981,  0.981,  0.981,  0.981],</span></span><br><span class="line"><span class="string">       [ 0.975,  0.975,  0.975,  0.975,  0.975]])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">S = S0 * mu * md</span><br><span class="line">S.<span class="built_in">round</span>(<span class="number">3</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">array([[ 100.   ,  100.634,  101.273,  101.915,  102.562],</span></span><br><span class="line"><span class="string">       [  98.743,   99.37 ,  100.   ,  100.634,  101.273],</span></span><br><span class="line"><span class="string">       [  97.502,   98.121,   98.743,   99.37 ,  100.   ],</span></span><br><span class="line"><span class="string">       [  96.276,   96.887,   97.502,   98.121,   98.743],</span></span><br><span class="line"><span class="string">       [  95.066,   95.669,   96.276,   96.887,   97.502]])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 这之中只有上三角矩阵matter.</span></span><br><span class="line"><span class="comment"># Although we do more calculations with this approach than are needed in principle, the approach is, as expected, much faster than the first version, which relies heavily on nested loops on the Python level:</span></span><br><span class="line"></span><br><span class="line">M = <span class="number">1000</span>  <span class="comment"># reset number of time steps</span></span><br><span class="line">%time <span class="built_in">round</span>(binomial_np(<span class="number">100</span>), <span class="number">3</span>) </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">CPU times: user 91.5 ms, sys: 15.2 ms, total: 107 ms</span></span><br><span class="line"><span class="string">Wall time: 106 ms</span></span><br><span class="line"><span class="string">10.449</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>以上部分参考书目：</p>
<p>《数理金融》（Paul Wilmott）</p>
<ul>
<li>Chapter 15 二叉树模型</li>
</ul>
<p>《Options, Futures and Other Derivatives》</p>
<ul>
<li>Chapter 12 Binomial Trees
<ul>
<li>建议与DerivaGem使用：http://www-2.rotman.utoronto.ca/~hull/software/index.html</li>
</ul></li>
<li>Chapter 20 Basic Numerical Procedures</li>
</ul>
<p>《The Mathematics of Finance: Modeling and Hedging》</p>
<ul>
<li>Chapter 2 Binomial Trees, Replicating Portfolios, and Arbitrage</li>
<li>Chapter 3 Tree Models for Stock and Options</li>
<li>Chapter 4 Using Spread Sheets to Compute Stock and Options
<ul>
<li>Excel表制作二叉树，给出波动率的情况下可以使用Hull的DerivaGem</li>
<li>No-Dividend Binomial Trees: https://accelerator086.github.io/accelerator086-Blogs-Books/No-Dividend Binomial Trees.xlsx</li>
</ul></li>
</ul>
<p>《Introduction to the Mathematics of Finance》</p>
<ul>
<li>Chapter 2 Binomial Model</li>
</ul>
<p>FRM《4 Valuation and Risk Models》</p>
<ul>
<li>Chapter 14 Binomial Trees</li>
</ul>
<p>《Mathematical Models of Financial Derivatives》</p>
<ul>
<li>Chapter 6 Numerical Schemes for Pricing Options</li>
</ul>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:accelerator086@outlook.com">Accelerator</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://accelerator086.github.io/2019/01/17/Notes-for-Financial-Derivatives-3/">http://accelerator086.github.io/2019/01/17/Notes-for-Financial-Derivatives-3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a> 许可协议。转载请注明来自 <a href="http://accelerator086.github.io" target="_blank">Accelerator086</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Financial-Mathematics/">Financial Mathematics</a><a class="post-meta__tags" href="/tags/Undergraduate/">Undergraduate</a><a class="post-meta__tags" href="/tags/Financial-Derivatives/">Financial Derivatives</a></div><div class="post_share"><div class="social-share" data-image="/pic/15888928.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/01/17/Notes-for-Financial-Derivatives-5/"><img class="prev-cover" src="/pic/new_folder4/Konachan142650.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Financial Derivatives Chapter 5：Preview-Stochastic Process</div></div></a></div><div class="next-post pull-right"><a href="/2019/01/17/Notes-for-Financial-Derivatives-4/"><img class="next-cover" src="/pic/new_folder4/Konachan142650.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Financial Derivatives Chapter 4：Options Pricing Principles</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%97%E5%88%A9-arbitrage"><span class="toc-number">1.</span> <span class="toc-text">套利 Arbitrage</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%A5%97%E5%88%A9%E5%AE%9A%E4%BB%B7%E5%8E%9F%E5%88%99"><span class="toc-number">1.1.</span> <span class="toc-text">无套利定价原则</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%9F%E6%9D%83%E5%AE%9A%E4%BB%B7%E7%9A%84%E4%BA%8C%E5%8F%89%E6%A0%91%E6%A8%A1%E5%9E%8B-binomial-tree"><span class="toc-number">2.</span> <span class="toc-text">期权定价的二叉树模型 Binomial Tree</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E8%88%AC%E4%BA%8C%E5%8F%89%E6%A0%91%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.1.</span> <span class="toc-text">一般二叉树模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%9C%9F%E4%BA%8C%E5%8F%89%E6%A0%91%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.2.</span> <span class="toc-text">单期二叉树模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A0%E5%A5%97%E5%88%A9%E5%AE%9A%E4%BB%B7%E6%B3%95%E4%B8%8B%E6%AC%A7%E5%BC%8F%E6%9C%9F%E6%9D%83%E5%AE%9A%E4%BB%B7%E5%85%AC%E5%BC%8F"><span class="toc-number">2.2.1.</span> <span class="toc-text">无套利定价法下欧式期权定价公式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#delta%E5%AF%B9%E5%86%B2%E6%8A%80%E6%9C%AF"><span class="toc-number">2.2.2.</span> <span class="toc-text">Delta对冲技术</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A3%8E%E9%99%A9%E4%B8%AD%E6%80%A7%E5%AE%9A%E4%BB%B7%E6%96%B9%E6%B3%95risk-neutral-valuation"><span class="toc-number">2.2.3.</span> <span class="toc-text">风险中性定价方法：Risk Neutral Valuation</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E6%9C%9F%E4%BA%8C%E5%8F%89%E6%A0%91%E6%A8%A1%E5%9E%8B-%E5%A4%9A%E6%9C%9F%E4%BA%8C%E5%8F%89%E6%A0%91%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.3.</span> <span class="toc-text">两期二叉树模型 &#x2F; 多期二叉树模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%9F%E6%9D%83%E5%AE%9A%E4%BB%B7%E6%96%B9%E6%B3%95%E5%80%92%E9%80%80%E5%AE%9A%E4%BB%B7%E6%B3%95%E9%A3%8E%E9%99%A9%E4%B8%AD%E6%80%A7%E5%AE%9A%E4%BB%B7%E6%B3%95"><span class="toc-number">2.3.1.</span> <span class="toc-text">期权定价方法：倒退定价法、风险中性定价法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E6%9C%9F%E4%BA%8C%E5%8F%89%E6%A0%91%E4%B8%AD%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-number">2.3.2.</span> <span class="toc-text">多期二叉树中的参数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%9F%E6%9D%83%E4%BA%8C%E5%8F%89%E6%A0%91%E5%AE%9A%E4%BB%B7-using-python"><span class="toc-number">2.4.</span> <span class="toc-text">期权二叉树定价 Using Python</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2022 By Accelerator086</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      true && mermaid.init()
    })
  }
}</script><script>function loadWaline () {
  function initWaline () {
    const waline = new Waline(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://blogwaline-alpha.vercel.app/',
      avatar: 'mp',
      avatarCDN: 'https://sdn.geekzu.org/avatar/',
      path: location.pathname,
      visitor: false,
      dark: 'html[data-theme="dark"]'
    }, null))
  }

  if (typeof Waline === 'function') initWaline() 
  else getScript('https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js').then(initWaline)
}

if ('Waline' === 'Waline' || !true) {
  if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><div class="aplayer no-destroy" data-id="621150623" data-server="netease" data-lrctype="0" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.removeEventListener('scroll', window.tocScrollFn)
  window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>